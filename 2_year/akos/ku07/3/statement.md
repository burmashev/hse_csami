|                      |       |
|----------------------|-------|
| **Time limit:**      | `1 s` |
| **Real time limit:** | `1 s` |
| **Memory limit:**    | `8M`  |


### Problem ku07-3: kr07-3 (дореш)

Напишите программу `socket_hash PORT BLOCK_SIZE`, которая слушает указанный порт по протоколу
TCP/IPv4 и на каждое входящее соединение отдаёт значение функции сжатия данных `size_t
compress(const char* prev_buf, char* data, size_t n, char* cur_buf) `, определённой извне. Указатели
`const char* prev_buf`, `char* cur_buf` должны быть предоставлены вами. Количество памяти,
необходимое указателям, вы должны получить из функции `size_t get_compress_buf_size()`. Функция
сжатия возвращает количество байт, полученное из сообщения после сжатия.

В указателе `const char* prev_buf` могут находиться данные, необходимые для продолжения сжатия
сообщения, и полученные из некоторого префикса сообщения. Это нужно для того, чтобы поддержать
буферизацию при сжатии данных. Соответственно, в указатель `char* cur_buf` функция пишет данные,
необходимые для продолжения сжатия сообщения после обработки текущего буфера (с учетом возможного
предыдущего буфера). Если предыдущего буфера не существует, в prev_buf должно быть значение NULL.

После сжатия данных отдайте клиенту количество байт после сжатия в виде 32-битного беззнакового
числа в бинарном виде в сетевом порядке байт и закройте соединение. Если полученное сообщение
превышает BLOCK_SIZE, отдайте клиенту значение 0 в виде 32-битного беззнакового числа и закройте
соединение.

Сообщением от клиента считается всё, что клиент передал до EOF. Сообщения бинарные. Сообщение в
несжатом виде может не помещаться в памяти процесса. Клиенты подключаются последовательно,
параллельная обработка соединений не требуется.

При получении SIGTERM программа должна завершиться с кодом 0.

Гарантируется, что указанный порт доступен. Не забывайте про опцию SO_REUSEADDR.

### Examples

#### Input

    
    
    ./socket_hash "$SOCKET_NO" 2048 &
    echo "Hello world" | nc -N localhost "$SOCKET_NO" | python3 -c 'import socket; print(socket.ntohl(int(input())))'
    kill "$(ps -C "./socket_hash" h | cut -f 2 -d " ")"

#### Output

    
    
    9

#### Input

    
    
    ./socket_hash "$SOCKET_NO" 2 &
    echo "Hello world" | nc -N localhost "$SOCKET_NO" | python3 -c 'import socket; print(socket.ntohl(int(input())))
    kill "$(ps -C "./socket_hash" h | cut -f 2 -d " ")"

#### Output

    
    
    0

